{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/shind/OneDrive/Desktop/coding project/blog post/blog_front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/shind/OneDrive/Desktop/coding project/blog post/blog_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/shind/OneDrive/Desktop/coding project/blog post/blog_front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//Components imports\nimport BlogPost from'../Components/BlogPost.js';import Category from'../Components/Category.js';import{React,useState,useEffect,useRef}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Main(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),Posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),Cats=_useState4[0],setCats=_useState4[1];var nullCat={categoryid:-1,category:'null'};var SelectedCats=useRef([nullCat]);var CurrUser=props.CurrUser;//runs only on mount\nuseEffect(function(){GetAllCats();},[]);function GetBlogs(_x){return _GetBlogs.apply(this,arguments);}function _GetBlogs(){_GetBlogs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(Cats){var StrCats;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:StrCats=Cats.map(function(Cat){return Cat.categoryid;}).toString();//converts the array of Categories into a string format to be sent in GET request\nfetch('/getblogs/'+StrCats).then(//fetches the blog posts under the requested categories from backend\nfunction(res){return res.json();}).then(function(response){var Posts=response.res;//response is an array of Posts if blog posts exists, and null otherwise\nsetPosts(Posts);//sets the Posts state to the response\n});case 2:case\"end\":return _context.stop();}}},_callee);}));return _GetBlogs.apply(this,arguments);}function OpenBlog(Post){props.OpenBlog(Post);}function GetAllCats(){fetch('/getallcats').then(//fetches all the categories from backend\nfunction(res){return res.json();}).then(function(response){var AllCats=response.res;//response is an array of Categories\nsetCats(AllCats);//sets the Categories state to the response\n});}function AddCatSelection(Cat){SelectedCats.current=SelectedCats.current.filter(function(SelectedCat){return SelectedCat.categoryid!==-1;});//removes null category from SelectedCats.current\nSelectedCats.current.push(Cat);//adds Category Cat to SelectedCats.current\nGetBlogs(SelectedCats.current);//get all the blogs for all categories after the selected categories have been modified\n}function RemoveCatSelection(Cat){SelectedCats.current=SelectedCats.current.filter(function(SelectedCat){return SelectedCat.categoryid!==Cat.categoryid;});//removes Category Cat from SelectdCats.current\n//if after removal SelectedCats.current is empty, add the nullCat\nif(SelectedCats.current.length==0){SelectedCats.current.push(nullCat);}GetBlogs(SelectedCats.current);//get all the blogs for all categories after the selected categories have been modified\n}return/*#__PURE__*/_jsxs(\"div\",{children:[Cats?Cats.map(function(Cat){return/*#__PURE__*/_jsx(Category,{Cat:Cat,AddCatSelection:AddCatSelection,RemoveCatSelection:RemoveCatSelection},Cat.categoryid);}):null,Posts?Posts.map(function(Post){{/* iterate through the Posts array if Posts is not null, and each post is Post */}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return OpenBlog(Post);},children:[\" \",/*#__PURE__*/_jsx(BlogPost,{Post:Post,CurrUser:CurrUser}),\" \"]}),/*#__PURE__*/_jsx(\"br\",{})]},Post.PostID);}):/*#__PURE__*/_jsx(\"div\",{children:\"There are no posts yet :(\"}),\" \"]});}export default Main;","map":{"version":3,"names":["BlogPost","Category","React","useState","useEffect","useRef","Main","props","Posts","setPosts","Cats","setCats","nullCat","categoryid","category","SelectedCats","CurrUser","GetAllCats","GetBlogs","StrCats","map","Cat","toString","fetch","then","res","json","response","OpenBlog","Post","AllCats","AddCatSelection","current","filter","SelectedCat","push","RemoveCatSelection","length","PostID"],"sources":["C:/Users/shind/OneDrive/Desktop/coding project/blog post/blog_front/src/Pages/Main.js"],"sourcesContent":["//Components imports\r\nimport BlogPost from '../Components/BlogPost.js'\r\nimport Category from '../Components/Category.js';\r\n\r\nimport {React, useState, useEffect, useRef} from 'react';\r\n\r\nfunction Main(props) {\r\n    const [Posts, setPosts] = useState(null)\r\n    const [Cats, setCats] = useState(null)\r\n    const nullCat = {categoryid: -1, category: 'null'}\r\n    const SelectedCats = useRef([nullCat])\r\n\r\n    const CurrUser = props.CurrUser;\r\n\r\n    //runs only on mount\r\n    useEffect( () => {\r\n        GetAllCats()\r\n    }, [])\r\n\r\n    async function GetBlogs(Cats) {\r\n        const StrCats = Cats.map(Cat => {return Cat.categoryid}).toString() //converts the array of Categories into a string format to be sent in GET request\r\n\r\n        fetch('/getblogs/' + StrCats).then( //fetches the blog posts under the requested categories from backend\r\n            res => {\r\n                return res.json()\r\n            }\r\n        ).then(\r\n            response => {\r\n                const Posts = response.res //response is an array of Posts if blog posts exists, and null otherwise\r\n                setPosts(Posts) //sets the Posts state to the response\r\n            }\r\n        )\r\n    }\r\n\r\n    function OpenBlog(Post) {\r\n        props.OpenBlog(Post)\r\n    }\r\n\r\n    function GetAllCats() {\r\n        fetch('/getallcats').then( //fetches all the categories from backend\r\n            res => {\r\n                return res.json()\r\n            }\r\n        ).then(\r\n            response => {\r\n                const AllCats = response.res //response is an array of Categories\r\n                setCats(AllCats) //sets the Categories state to the response\r\n            }\r\n        )\r\n    }\r\n\r\n    function AddCatSelection(Cat) {\r\n        SelectedCats.current = SelectedCats.current.filter(SelectedCat => SelectedCat.categoryid !== -1) //removes null category from SelectedCats.current\r\n        SelectedCats.current.push(Cat) //adds Category Cat to SelectedCats.current\r\n        GetBlogs(SelectedCats.current) //get all the blogs for all categories after the selected categories have been modified\r\n    }\r\n\r\n    function RemoveCatSelection(Cat) {\r\n        SelectedCats.current = SelectedCats.current.filter(SelectedCat => SelectedCat.categoryid !== Cat.categoryid) //removes Category Cat from SelectdCats.current\r\n\r\n        //if after removal SelectedCats.current is empty, add the nullCat\r\n        if (SelectedCats.current.length == 0) {\r\n            SelectedCats.current.push(nullCat)\r\n        }\r\n        GetBlogs(SelectedCats.current) //get all the blogs for all categories after the selected categories have been modified\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {/* Displays All Categories if it is not null */}\r\n            {Cats ? Cats.map(Cat => {\r\n                return (\r\n                    <Category key={Cat.categoryid} Cat={Cat} AddCatSelection={AddCatSelection} RemoveCatSelection={RemoveCatSelection} />\r\n                )\r\n            }) : null}\r\n            \r\n            {Posts ? Posts.map(Post => { {/* iterate through the Posts array if Posts is not null, and each post is Post */}\r\n                return (\r\n                    <div key={Post.PostID}>\r\n                        <button onClick={() => OpenBlog(Post)}> {/* Call the OpenBlog method with parameter Post */}\r\n                            <BlogPost Post={Post} CurrUser={CurrUser} /> {/* Display the specific Blog Post, passing in information of Post as a prop Post */}\r\n                        </button>\r\n                        <br />\r\n                    </div>\r\n                )\r\n            }) : <div>There are no posts yet :(</div> } {/* If Posts is null-if there are no Posts */}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Main;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}